<!DOCTYPE html>

    <head>
        <title>POST ROOM</title>
        <meta charset='utf-8'>
        <%- include ('../partials/head'); %>
        <style>
            #navbar{
             margin-right: 12px;
            }
         </style>
    </head>

    <body class = "container">
        <%if(locals.capacity && locals.number&& locals.floor){%>
            <%=capacity%>
            <%=number%>
            <%=floor%>
        <%}%>
        <h1>
           POST ROOM
        </h1>   
        <header>
            <nav>
                <a href = "/home" id = "navbar"> Home</a>
                <a href = "/room/get" id = "navbar"> GET</a> 
                <a href = "/room/put" id = "navbar"> PUT</a> 
                <a href = "/room/post" id = "navbar"> POST</a> 
                <a href = "/room/delete" id = "navbar"> DELETE</a>  
            </nav>
        </header>  
        <div class = "row">
            <div class = "col pr-0">
                <main class = "jumbotron" style = "height:100%;">
                    <h2>POST ROOM</h2>
                    
                    
                    <form action = "/room/post" method = "post" style = "text-align: left;" onclick="after_submit()">
                        Select Floor: 
                        <select name = "selectedfloor" class = "form-control">
                            <%if(locals.available_floors && locals.non_maxed_room_numbers){%>
                                <%locals.available_floors.forEach (function(x){%>
                                    <%locals.non_maxed_room_numbers.forEach(function(y){%>
                                        <%if(x.level == y){%>
                                            <option value = "<%=x.id%> <%=x.level%>"> <%=y%></option>
                                        <%}%>
                                        
                                    <%})%>
                                    
                                <%})%>
                            <%}%>
                            
                        </select>
                        <br>
                        Room Number: <input type = "text" name = "number" placeholder = "Ex: Floor 2 (#201 - #210) *Input Number" class = "form-control" required><br>
                        Capacity: <input type = "text" name = "capacity" class = "form-control" required placeholder = "Input Capacity Number"><br>
                        <input type = "submit" class ="btn btn-primary">
                        
                    </form><br>
                    <%if (locals.api_response){%>
                        <%if (api_response.includes("Invalid") || api_response.includes("Already")){%>
                            <span style = "color:red; font-weight: bold;"><%=api_response%></span>
                        <%}
                        else{%>
                            <span style = "color:green; font-weight: bold;"><%=api_response%></span>
                            <%}
                        %>
                    <%}%>
                    
                </main>
            </div>


            <div class = "col pl-0">
                <main class = "jumbotron" style = "height:100%;">
                    <h2>Room Database</h2>
                    <table class = "table table-sm table-primary" style = "width:60%;">
                        <tr>
                            
                            <th class = "text-center">Floor</th>
                            <th class = "text-center">Number</th>
                            <th class = "text-center">Capacity</th>
                        </tr>
                            <%if(locals.available_rooms){%>
                                <%locals.available_rooms.forEach(function(x){%>
                                
                                    <%if(locals.room_level && locals.capacity && locals.number){%>
                                        <%if(x.level == room_level && x.capacity == capacity && x.number == number){%>
                                            <tr>
                                                <td class = "text-center" style = "background-color: rgb(200, 255, 200);"><%=x.level%></td>
                                                <td class = "text-center" style = "background-color: rgb(200, 255, 200);">#<%=x.number%></td>
                                                <td class = "text-center" style = "background-color: rgb(200, 255, 200);"><%=x.capacity%></td>
                                            </tr>
                                        <%}
                                        else{%>
                                            <tr>
                                                <td class = "text-center"><%=x.level%></td>
                                                <td class = "text-center">#<%=x.number%></td>
                                                <td class = "text-center"><%=x.capacity%></td>
                                            </tr>
                                        <%}%>
                                        
                                    <%}
                                    else{%>
                                        <tr>
                                            <td class = "text-center"><%=x.level%></td>
                                            <td class = "text-center">#<%=x.number%></td>
                                            <td class = "text-center"><%=x.capacity%></td>
                                        </tr>
                                    <%}%>
                                
                                
                                <%})%>
                            <%}%>
                    </table>


                </main>

            </div>
        </div>

        <script>
            if (window.history.replaceState){
                    window.history.replaceState( null, null, window.location.href );
            }
        </script>
        
        <footer>
            <%- include('../partials/footer.ejs'); %>
        </footer>
    </body>
    
</html>
        

<!-- Preventing form resubmission on reload - https://stackoverflow.com/questions/6320113/how-to-prevent-form-resubmission-when-page-is-refreshed-f5-ctrlr -->