<!DOCTYPE html>

    <head>
        <title>PUT RESIDENT</title>
        <meta charset='utf-8'>
        <%- include ('../partials/head'); %>
        <style>
            #navbar{
             margin-right: 12px;
            }
            
         </style>
    </head>

    <body class = "container">
        <h1>
           PUT RESIDENT
        </h1>   
        <header>
            <nav>
                <a href = "/home"  id = "navbar"> Home</a> 
                <a href = "/resident/get" id = "navbar"> GET</a> 
                <a href = "/resident/put" id = "navbar"> PUT</a> 
                <a href = "/resident/post" id = "navbar"> POST</a> 
                <a href = "/resident/delete" id = "navbar"> DELETE</a>
            </nav>
        </header>  
        <div class = "row">
            <div class= "col pr-0">
                <main class = "jumbotron" style = "height:100%;">
            
                    <h2>Update a Resident</h2>
        
                    <form action = "/resident/put" method = "post" style = "text-align: left;" >
                        Resident to Update: 
                        <select name = "id" class = "form-control">
                            <option value = "">Select a Resident:</option>
                            <%if (locals.available_residents){%>
                                <%locals.available_residents.forEach(function (x)
                                {%>
                                    <option value = "<%=x.id%>"> <%=x.firstname%> <%=x.lastname%> - Age: <%=x.age%> - Room: #<%=x.number%> </option>     
                                <%})%>
                            <%}%>
                            
                            
                        </select>
                        <br>
                        New First Name: <input type = "text" name = "firstname" class = "form-control" placeholder = "Update First Name"> <br>
                        New Last Name: <input type = "text" name = "lastname" class = "form-control" placeholder = "Update Last Name"> <br>
                        New Age: <input type = "text" name = "age"  class = "form-control" placeholder = "Update Age"> <br>

                        New Room: <select name = "room" class = "form-control">
                            <option value="">Update Room #</option>
                            <%if(locals.available_rooms){%>
                                <%locals.available_rooms.forEach(function(y){%>
                                    <option value = "<%=y.number%>" > #<%=y.number%> </option>
                                <%})%>
                            <%}%>
                            
                            
                        </select> <br> 
                        <input type = "submit" class = "btn btn-primary"><br><br>
                        <%if (locals.api_response){%>
                            <%if (api_response.includes('No')){%>
                                <span style = "color: red; font-weight: bold;"><%=api_response%></span>
                            <%}
                            else{%>
                                <span style = "color: green; font-weight: bold;"><%=api_response%></span>
                            <%}%>
                        <%}%>
                    </form>
                        
        
                </main>
            </div>
            <div class = "col pl-0">
                <main class = "jumbotron" style = "height:100%;">
                    <h2>Resident Database</h2>
                    <table class = "table-sm table table-primary" style = "width:100%;">
                        <tr>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Age</th>
                            <th>Room</th>
                        </tr>
                        <%if(locals.available_residents){%>
                            <%if(locals.resident_id){%>




                                <%locals.available_residents.forEach(function(x){%>
                                    <tr>
                                        <%if(x.id == resident_id && api_response!= "No Update Provided"){%>
                                             
                                            <%if(locals.res_info){%>
                                                <%if(x.firstname == res_info.firstname){%>
                                                    <td style = "background-color: rgb(200,255,200); color: red;"><%=x.firstname%></td>
                                                <%}
                                                else{%>
                                                    <td style = "background-color: rgb(200,255,200)"><%=x.firstname%></td>
                                                <%}%>

                                                
                                                <%if(x.lastname == res_info.lastname){%>
                                                    <td style = "background-color: rgb(200,255,200); color: red;"><%=x.lastname%></td>
                                                <%}
                                                else{%>
                                                    <td style = "background-color: rgb(200,255,200)"><%=x.lastname%></td>
                                                <%}%>


                                                <%if(x.age == res_info.age){%>
                                                    <td style = "background-color: rgb(200,255,200); color: red;"><%=x.age%></td>
                                                <%}
                                                else{%>
                                                    <td style = "background-color: rgb(200,255,200)"><%=x.age%></td>
                                                <%}%>


                                                <%if(res_info.room != ""){%>
                                                    <td style = "background-color: rgb(200,255,200); color: red;">#<%=res_info.room%></td>
                                                <%}
                                                else{%>
                                                    <td style = "background-color: rgb(200,255,200)">#<%=x.number%></td>
                                                <%}%>




                                                 
                                            <%}%>
                                            

                                        <%}
                                        else{%>
                                            <td><%=x.firstname%></td>
                                            <td ><%=x.lastname%></td>
                                            <td ><%=x.age%></td>
                                            <td >#<%=x.number%></td>
                                        <%}%>
                                       
                                            
                                        
                                    </tr>
                                        
                                <%})%>



                            <%}
                            else{%>

                                <%locals.available_residents.forEach(function(x){%>
                                    <tr>
                                        <td><%=x.firstname%></td>
                                        <td ><%=x.lastname%></td>
                                        <td ><%=x.age%></td>
                                        <td >#<%=x.number%></td>
                                    </tr>
                                <%})%>
                            <%}%>        
                        <%}%>
                    </table>
                </main>
            </div>
        </div>

        <script>
            if (window.history.replaceState){
                    window.history.replaceState( null, null, window.location.href );
            }
        </script>
        

        <footer>
            <%- include('../partials/footer.ejs'); %>
        </footer>
    </body>
    
</html>
        
